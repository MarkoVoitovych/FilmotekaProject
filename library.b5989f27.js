var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},o={},n=e.parcelRequiree717;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in o){var n=o[e];delete o[e];var a={id:e,exports:{}};return t[e]=a,n.call(a.exports,a,a.exports),a.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},e.parcelRequiree717=n),n("98QzK"),n("iQIUW");const a={library:document.querySelector(".gallery--library"),footerLink:document.querySelector(".footer__link"),footerBackDrop:document.querySelector(".footer__backdrop"),footerCloseBtn:document.querySelector("[data-modal-close]"),watchBtn:document.querySelector(".button-watched"),queueBtn:document.querySelector(".button-queue")};function r(e,t){const{id:o,poster_path:n,title:a,release_date:r,vote_average:i}=e,s=i.toFixed(1);return`<li class="gallery__item movie-card" data-id="${o}">\n                  <div class="movie-card__poster-thumb">\n                    <img src="${e.poster_path?`https://image.tmdb.org/t/p/w300${n}`:"https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png"}"\n                        class="movie-card__poster"\n                        alt="${a}"\n                                            />\n                  </div>\n                  <div class="movie-card__wrap">\n                      <h2 class="movie-info-title"> ${a}</h2>\n                      <div class="movie-info-list">\n                      <p class="info-item-genre">${t}</p>\n                        <span class="info-item-slash"> | </span>\n                        <p class="info-item-year">${new Date(Date.parse(r)).getFullYear()||""}</p>\n                        <span class="info-item-vote">${s}</span>\n                      </div>\n                  </div>\n            </li>`}var i=n("9ECFy"),s=n("jiL1b"),l=n("1GioC"),c=n("9XPaE");function d(){a.footerBackDrop.classList.add("is-hidden"),p()}function u(e){"Escape"!==e.key&&e.target!==a.footerBackDrop||(a.footerBackDrop.classList.add("is-hidden"),p())}function p(){document.removeEventListener("keydown",u),a.footerBackDrop.removeEventListener("click",u),a.footerCloseBtn.removeEventListener("click",d),document.querySelector("body").classList.remove("noScroll")}const m=new(0,i.ThemoviedbAPI);try{(0,l.spinnerPlay)(),f(),a.footerLink.addEventListener("click",(function(){a.footerBackDrop.classList.remove("is-hidden"),document.querySelector("body").classList.add("noScroll"),document.addEventListener("keydown",u),a.footerBackDrop.addEventListener("click",u),a.footerCloseBtn.addEventListener("click",d)}))}catch(e){console.log(e)}finally{(0,l.spinnerStop)()}function v(e){const t=document.querySelector(".js-title-queue"),o=document.querySelector(".js-library-bg-image"),n=document.querySelector("main");e.length>0&&(t.classList.add("visually-hidden"),o.classList.add("visually-hidden"),n.classList.remove("perspective")),0===e.length&&(t.classList.remove("visually-hidden"),o.classList.remove("visually-hidden"),n.classList.add("perspective"))}async function f(){a.library.innerHTML="";const e=(0,c.get)(m.WATCH_KEY);v(e);e.map((e=>e.id)).forEach((async e=>{const t=await m.fetchMovieById(e),o=t.genres.map((e=>e.name));o.length>2&&o.splice(2,o.length-1,"Other"),0===o.length&&o.push("Other"),a.library.insertAdjacentHTML("beforeend",r(t,o.join(", "))),a.library.lastElementChild.setAttribute("data-status","watched")}))}function h(e,t,o,n,a,r){const i=(0,c.get)(e),s=t,l=i.find((e=>e.id===s.id));l&&(o.dataset.list=`${r}`,o.textContent=`${n}`,o.addEventListener("click",a)),l||o.classList.add("visually-hidden")}a.watchBtn.addEventListener("click",f),a.queueBtn.addEventListener("click",(async function(){a.library.innerHTML="";const e=(0,c.get)(m.QUEUE_KEY);v(e);e.map((e=>e.id)).forEach((async e=>{const t=await m.fetchMovieById(e),o=t.genres.map((e=>e.name));o.length>2&&o.splice(2,o.length-1,"Other"),0===o.length&&o.push("Other"),a.library.insertAdjacentHTML("beforeend",r(t,o.join(", "))),a.library.lastElementChild.setAttribute("data-status","queue")}))})),a.library.addEventListener("click",(async function(e){const t=e.target.closest(".gallery__item");try{(0,l.spinnerPlay)();const e=t.dataset.id,o=t.dataset.status;await m.fetchMovieById(e).then((e=>{const n=e.poster_path?`https://image.tmdb.org/t/p/w300${e.poster_path}`:"https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png",a=new Date(Date.parse(e.release_date)).getFullYear(),r={id:e.id,poster:n,title:e.title,originalTitle:e.original_title,genres:[],popularity:e.popularity,overview:e.overview,vote_average:e.vote_average.toFixed(1),vote_count:e.vote_count,release_date:a};e.genres.forEach((e=>{r.genres.push(e.name)})),r.genres=r.genres.join(", "),(0,s.createModalMarkUp)(r);const i=document.querySelector(".lightbox-modal__watched-button"),l=document.querySelector(".lightbox-modal__queque-button");h(m.WATCH_KEY,r,i,"Remove from Watched",(function(e){const o=e.target.dataset.btn;"watched"===e.target.dataset.list&&((0,c.removeLocal)(m.WATCH_KEY,o),t.remove(),e.target.textContent="Removed from Watched",e.target.disabled=!0)}),"watched"),h(m.QUEUE_KEY,r,l,"Remove from Queque",(function(e){const n=e.target.dataset.btn;"queue"===o&&(e.target.textContent="Removed from Queque",e.target.disabled=!0,(0,c.removeLocal)(m.QUEUE_KEY,n),t.remove())}),"queque")}))}catch(e){console.log(e)}finally{(0,l.spinnerStop)()}}));
//# sourceMappingURL=library.b5989f27.js.map
