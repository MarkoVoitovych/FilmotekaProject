{"mappings":"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","sources":["src/javascript/library.js","src/javascript/libRefs.js","src/javascript/renderLibraryMarkUp.js","src/javascript/libraryFooterModalOpen.js"],"sourcesContent":["import BigPicture from 'bigpicture';\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\n\nimport { libRefs } from './libRefs';\nimport { renderLibraryMarkup } from './renderLibraryMarkUp';\nimport { ThemoviedbAPI } from './themoviedbAPI';\nimport { createModalMarkUp } from './renderModalMarkUp';\nimport { spinnerPlay, spinnerStop } from './spiner';\nimport { get, removeLocal } from './localStorageUse';\nimport { libraryFooterModalOpen } from './libraryFooterModalOpen';\n\nconst themoviedbAPI = new ThemoviedbAPI();\n\ntry {\n  spinnerPlay();\n  renderWatchedMovies();\n  libRefs.footerLink.addEventListener('click', libraryFooterModalOpen);\n} catch (error) {\n  console.log(error);\n} finally {\n  spinnerStop();\n}\n\nlibRefs.watchBtn.addEventListener('click', renderWatchedMovies);\nlibRefs.queueBtn.addEventListener('click', renderQueueMovies);\nlibRefs.library.addEventListener('click', onMovieCardClick);\n\nfunction displayBg(array) {\n  const emptyTitle = document.querySelector('.js-title-queue');\n  const emptyImg = document.querySelector('.js-library-bg-image');\n  const mainEl = document.querySelector('main');\n  if (array.length > 0) {\n    emptyTitle.classList.add('visually-hidden');\n    emptyImg.classList.add('visually-hidden');\n    mainEl.classList.remove('perspective');\n  }\n  if (array.length === 0) {\n    emptyTitle.classList.remove('visually-hidden');\n    emptyImg.classList.remove('visually-hidden');\n    mainEl.classList.add('perspective');\n  }\n}\n\nasync function renderWatchedMovies() {\n  libRefs.library.innerHTML = '';\n  const watchedMovies = get(themoviedbAPI.WATCH_KEY);\n  displayBg(watchedMovies);\n  const watchedMoviesIds = watchedMovies.map(movie => movie.id);\n  watchedMoviesIds.forEach(async id => {\n    const movie = await themoviedbAPI.fetchMovieById(id);\n    const genre = movie.genres.map(genre => genre.name);\n    if (genre.length > 2) {\n      genre.splice(2, genre.length - 1, 'Other');\n    }\n    if (genre.length === 0) {\n      genre.push('Other');\n    }\n    libRefs.library.insertAdjacentHTML(\n      'beforeend',\n      renderLibraryMarkup(movie, genre.join(', '))\n    );\n    libRefs.library.lastElementChild.setAttribute('data-status', 'watched');\n  });\n}\n\nasync function renderQueueMovies() {\n  libRefs.library.innerHTML = '';\n  const queueMovies = get(themoviedbAPI.QUEUE_KEY);\n  displayBg(queueMovies);\n  const queueMoviesIDes = queueMovies.map(movie => movie.id);\n  queueMoviesIDes.forEach(async id => {\n    const movie = await themoviedbAPI.fetchMovieById(id);\n    const genre = movie.genres.map(genre => genre.name);\n    if (genre.length > 2) {\n      genre.splice(2, genre.length - 1, 'Other');\n    }\n    if (genre.length === 0) {\n      genre.push('Other');\n    }\n    libRefs.library.insertAdjacentHTML(\n      'beforeend',\n      renderLibraryMarkup(movie, genre.join(', '))\n    );\n    libRefs.library.lastElementChild.setAttribute('data-status', 'queue');\n  });\n}\n\nasync function onMovieCardClick(event) {\n  const movieCard = event.target.closest('.gallery__item');\n  try {\n    spinnerPlay();\n    const movieId = movieCard.dataset.id;\n    const movieStatus = movieCard.dataset.status;\n    console.log(movieStatus);\n    await themoviedbAPI.fetchMovieById(movieId).then(data => {\n      const posterPath = data.poster_path\n        ? `https://image.tmdb.org/t/p/w300${data.poster_path}`\n        : `https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png`;\n      const releaseYear = new Date(Date.parse(data.release_date)).getFullYear();\n      const filmData = {\n        id: data.id,\n        poster: posterPath,\n        title: data.title,\n        originalTitle: data.original_title,\n        genres: [],\n        popularity: data.popularity,\n        overview: data.overview,\n        vote_average: data.vote_average.toFixed(1),\n        vote_count: data.vote_count,\n        release_date: releaseYear,\n      };\n\n      data.genres.forEach(genre => {\n        filmData.genres.push(genre.name);\n      });\n      filmData.genres = filmData.genres.join(', ');\n\n      createModalMarkUp(filmData);\n    });\n\n    const removeFromWatchedBtn = document.querySelector(\n      '.lightbox-modal__watched-button'\n    );\n    removeFromWatchedBtn.textContent = 'Remove from Watched';\n\n    const removeFromQuequeBtn = document.querySelector(\n      '.lightbox-modal__queque-button'\n    );\n    removeFromQuequeBtn.textContent = 'Remove from Queque';\n\n    removeFromWatchedBtn.addEventListener('click', e => {\n      const movieId = e.target.closest('.lightbox-modal').dataset.id;\n      removeLocal(themoviedbAPI.WATCH_KEY, movieId);\n      if (movieStatus === 'watched') {\n        movieCard.remove();\n      }\n    });\n    removeFromQuequeBtn.addEventListener('click', e => {\n      const movieId = e.target.closest('.lightbox-modal').dataset.id;\n      removeLocal(themoviedbAPI.QUEUE_KEY, movieId);\n      if (movieStatus === 'queue') {\n        movieCard.remove();\n      }\n    });\n  } catch (error) {\n    console.log(error);\n  } finally {\n    spinnerStop();\n  }\n}\n","export const libRefs = {\n    library: document.querySelector('.gallery--library'),\n    footerLink: document.querySelector('.footer__link'),\n    footerBackDrop: document.querySelector('.footer__backdrop'),\n    footerCloseBtn: document.querySelector('[data-modal-close]'),\n    watchBtn: document.querySelector('.button-watched'),\n    queueBtn: document.querySelector('.button-queue'),\n}\n\n","export function renderLibraryMarkup(data, genres) {\n  const { id, poster_path, title, release_date, vote_average } = data;\n  const votes = vote_average.toFixed(1);\n  const posterPath = data.poster_path\n    ? `https://image.tmdb.org/t/p/w300${poster_path}`\n    : `https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png`;\n  const releaseYear = new Date(Date.parse(release_date)).getFullYear() || '';\n\n  return `<li class=\"gallery__item movie-card\" data-id=\"${id}\">\n                  <div class=\"movie-card__poster-thumb\">\n                    <img src=\"${posterPath}\"\n                        class=\"movie-card__poster\"\n                        alt=\"${title}\"\n                                            />\n                  </div>\n                  <div class=\"movie-card__wrap\">\n                      <h2 class=\"movie-info-title\"> ${title}</h2>\n                      <div class=\"movie-info-list\">\n                      <p class=\"info-item-genre\">${genres}</p>\n                        <span class=\"info-item-slash\"> | </span>\n                        <p class=\"info-item-year\">${releaseYear}</p>\n                        <span class=\"info-item-vote\">${votes}</span>\n                      </div>\n                  </div>\n            </li>`;\n}\n","import { libRefs } from './libRefs';\n\nexport function libraryFooterModalOpen() {\n    libRefs.footerBackDrop.classList.remove('is-hidden');\n    document.querySelector(\"body\").classList.add('noScroll');\n    document.addEventListener('keydown', hideFooterModal);\n    libRefs.footerBackDrop.addEventListener(\"click\", hideFooterModal);\n    libRefs.footerCloseBtn.addEventListener(\"click\", footerCloseBtnOnClick)\n}\n\nfunction footerCloseBtnOnClick() {\n    libRefs.footerBackDrop.classList.add('is-hidden');\n    removeListeners();\n}\n\nfunction hideFooterModal(e) {\n    if (e.key === 'Escape' || e.target === libRefs.footerBackDrop) {\n        libRefs.footerBackDrop.classList.add('is-hidden');\n        removeListeners();\n    }\n}\n\nfunction removeListeners() {\n    document.removeEventListener('keydown', hideFooterModal);\n    libRefs.footerBackDrop.removeEventListener(\"click\", hideFooterModal);\n    libRefs.footerCloseBtn.removeEventListener(\"click\", footerCloseBtnOnClick);\n    document.querySelector(\"body\").classList.remove('noScroll');\n}"],"names":["$bpxeT","parcelRequire","$4f1ca7faaad88fce$export$a53e322463ec8607","library","document","querySelector","footerLink","footerBackDrop","footerCloseBtn","watchBtn","queueBtn","$d30463d709471341$export$271debc1213d424c","data","genres","id","poster_path","title","release_date","votes","vote_average","toFixed","posterPath","concat","releaseYear","Date","parse","getFullYear","$4044ea41c59a9632$var$footerCloseBtnOnClick","classList","add","$4044ea41c59a9632$var$removeListeners","$4044ea41c59a9632$var$hideFooterModal","e","key","target","removeEventListener","remove","$05dc186ade895b4b$var$themoviedbAPI","$X3bd8","ThemoviedbAPI","$ddUeE","spinnerPlay","$05dc186ade895b4b$var$renderWatchedMovies","addEventListener","error","console","log","spinnerStop","$05dc186ade895b4b$var$displayBg","array","emptyTitle","emptyImg","mainEl","length","$05dc186ade895b4b$var$_renderWatchedMovies","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee1","watchedMovies","innerHTML","$2ZtFH","get","WATCH_KEY","map","movie","forEach","_callee","genre1","fetchMovieById","_ctx","sent","genre","name","splice","push","insertAdjacentHTML","join","lastElementChild","setAttribute","$05dc186ade895b4b$var$_renderQueueMovies","_callee2","queueMovies","QUEUE_KEY","genre2","$05dc186ade895b4b$var$_onMovieCardClick","event","movieCard","movieId1","movieStatus","removeFromWatchedBtn","removeFromQuequeBtn","closest","dataset","status","then","filmData","poster","originalTitle","original_title","popularity","overview","vote_count","$d1Qha","createModalMarkUp","textContent","movieId","removeLocal","t0"],"version":3,"file":"library.63a9ebd4.js.map"}