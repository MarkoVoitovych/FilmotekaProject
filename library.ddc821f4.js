var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},o={},n=e.parcelRequiree717;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in o){var n=o[e];delete o[e];var r={id:e,exports:{}};return t[e]=r,n.call(r.exports,r,r.exports),r.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){o[e]=t},e.parcelRequiree717=n),n("98QzK"),n("iQIUW");const r={library:document.querySelector(".gallery--library"),footerLink:document.querySelector(".footer__link"),footerBackDrop:document.querySelector(".footer__backdrop"),footerCloseBtn:document.querySelector("[data-modal-close]"),watchBtn:document.querySelector(".button-watched"),queueBtn:document.querySelector(".button-queue")};var a=n("4PM3P"),i=n("9ECFy"),c=n("jiL1b"),l=n("1GioC"),s=n("9XPaE");function d(){r.footerBackDrop.classList.add("is-hidden"),p()}function u(e){"Escape"!==e.key&&e.target!==r.footerBackDrop||(r.footerBackDrop.classList.add("is-hidden"),p())}function p(){document.removeEventListener("keydown",u),r.footerBackDrop.removeEventListener("click",u),r.footerCloseBtn.removeEventListener("click",d),document.querySelector("body").classList.remove("noScroll")}const f=new(0,i.ThemoviedbAPI);try{(0,l.spinnerPlay)(),y(),r.footerLink.addEventListener("click",(function(){r.footerBackDrop.classList.remove("is-hidden"),document.querySelector("body").classList.add("noScroll"),document.addEventListener("keydown",u),r.footerBackDrop.addEventListener("click",u),r.footerCloseBtn.addEventListener("click",d)}))}catch(e){console.log(e)}finally{(0,l.spinnerStop)()}async function y(){r.library.innerHTML="";(0,s.get)(f.WATCH_KEY).map((e=>e.id)).forEach((async e=>{const t=await f.fetchMovieById(e),o=t.genres.map((e=>e.name));o.length>2&&o.splice(2,o.length-1,"Other"),0===o.length&&o.push("Other"),r.library.insertAdjacentHTML("beforeend",(0,a.renderMarkup)(t,o.join(", "))),r.library.lastElementChild.setAttribute("data-status","watched")}))}r.watchBtn.addEventListener("click",y),r.queueBtn.addEventListener("click",(async function(){r.library.innerHTML="";const e=(0,s.get)(f.QUEUE_KEY);e.map((e=>e.id)).forEach((async e=>{const t=await f.fetchMovieById(e),o=t.genres.map((e=>e.name));o.length>2&&o.splice(2,o.length-1,"Other"),0===o.length&&o.push("Other"),r.library.insertAdjacentHTML("beforeend",(0,a.renderMarkup)(t,o.join(", "))),r.library.lastElementChild.setAttribute("data-status","queue")}))})),r.library.addEventListener("click",(async function(e){const t=e.target.closest(".gallery__item");try{(0,l.spinnerPlay)();const e=t.dataset.id,o=t.dataset.status;console.log(o),await f.fetchMovieById(e).then((e=>{const t=e.poster_path?`https://image.tmdb.org/t/p/w300${e.poster_path}`:"https://astoriamuseums.org/wp-content/uploads/2020/10/OFM-poster-not-available.png",o=new Date(Date.parse(e.release_date)).getFullYear(),n={id:e.id,poster:t,title:e.title,originalTitle:e.original_title,genres:[],popularity:e.popularity,overview:e.overview,vote_average:e.vote_average,vote_count:e.vote_count,release_date:o};e.genres.forEach((e=>{n.genres.push(e.name)})),n.genres=n.genres.join(", "),(0,c.createModalMarkUp)(n)}));const n=document.querySelector(".lightbox-modal__watched-button");n.textContent="Remove from Watched";const r=document.querySelector(".lightbox-modal__queque-button");r.textContent="Remove from Queque",n.addEventListener("click",(e=>{const n=e.target.closest(".lightbox-modal").dataset.id;(0,s.removeLocal)(f.WATCH_KEY,n),"watched"===o&&t.remove()})),r.addEventListener("click",(e=>{const n=e.target.closest(".lightbox-modal").dataset.id;(0,s.removeLocal)(f.QUEUE_KEY,n),"queue"===o&&t.remove()}))}catch(e){console.log(e)}finally{(0,l.spinnerStop)()}}));
//# sourceMappingURL=library.ddc821f4.js.map
